<!DOCTYPE html>

<html lang="zh-CN"  class="">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="keywords" content="">
    
    
    <meta name="description" content="">
    
    <meta name="generator" content="teedoc">
    <meta name="theme" content="teedoc-plugin-theme-default">
    
        
        <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        
        <script>
MathJax = {"loader": {"load": ["output/svg"]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}};
</script>
        
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <script src="/lhfdoc.github.io/static/js/theme_default/pre_main.js"></script>
        
        <link rel="stylesheet" href="/lhfdoc.github.io/static/css/theme_default/prism.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/lhfdoc.github.io/static/css/theme_default/viewer.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/lhfdoc.github.io/static/css/theme_default/dark.css" type="text/css"/>
        
        <link rel="stylesheet" href="/lhfdoc.github.io/static/css/theme_default/light.css" type="text/css"/>
        
        <script src="/lhfdoc.github.io/static/js/theme_default/jquery.min.js"></script>
        
        <script src="/lhfdoc.github.io/static/js/theme_default/split.js"></script>
        
        <link rel="stylesheet" href="/lhfdoc.github.io/static/css/search/style.css" type="text/css"/>
        
        <link rel="stylesheet" href="/lhfdoc.github.io/static/css/custom.css" type="text/css"/>
        
    
    
    <title>OpenEarable 2.0 源码架构分析 - 7h4Worker</title>
    
    <script type="text/javascript">js_vars = {}</script>
    <script type="text/javascript">metadata = {"tags": [], "date": null, "update": [], "ts": 0, "author": "", "brief": "", "cover": ""}</script>
</head>


<body class="type_doc">
    
    <div id="navbar">
        <div id="navbar_menu">
            <a class="site_title" href="/lhfdoc.github.io/">
                
                
                    <h2>嵌入式开发</h2>
                
        </a>
            <a id="navbar_menu_btn"></a>
        </div>
        <div id="navbar_items">
            <div>
                <ul id="nav_left">
</ul>

            </div>
            <div>
                <ul id="nav_right">
</ul>

                <ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">搜索</span>
                            <div id="search_hints">
                                <span id="search_input_hint">输入关键词，多关键词空格隔开</span>
                                <span id="search_loading_hint">正在加载，请稍候。。。</span>
                                <span id="search_download_err_hint">下载文件失败，请刷新重试或检查网络</span>
                                <span id="search_other_docs_result_hint">来自其它文档的结果</span>
                                <span id="search_curr_doc_result_hint">当前文档搜索结果</span>
                            </div></a></li></ul>
            </div>
        </div>
    </div>
    
    <div id="wrapper">
        <div id="sidebar_wrapper">
            <div id="sidebar">
                <div id="sidebar_title">
                    
                </div>
                <ul class="show">
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/index.html"><span class="label">嵌入式开发</span><span class=""></span></a></li>
<li class="active_parent no_link"><a><span class="label">🎧 OpenEarable 2.0</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/index.html"><span class="label">项目入门</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/project-overview.html"><span class="label">📋 项目概述</span><span class=""></span></a></li>
<li class="active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/architecture.html"><span class="label">🏗️ 系统架构</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/deployment.html"><span class="label">🚀 部署指南</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/teedoc-guide.html"><span class="label">📖 teedoc使用指南</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">核心功能模块</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/battery-module.html"><span class="label">🔋 电源管理模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/audio-module.html"><span class="label">🎵 音频处理模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/sensor-module.html"><span class="label">📡 传感器管理模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/bluetooth-module.html"><span class="label">📶 蓝牙通信模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/storage-module.html"><span class="label">💾 数据存储模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/drivers-module.html"><span class="label">🔧 硬件驱动模块</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">辅助功能模块</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/buttons-module.html"><span class="label">🎮 按键处理模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/parseinfo-module.html"><span class="label">📊 数据解析模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/wire-module.html"><span class="label">🔌 I2C通信模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/openearable/utils-module.html"><span class="label">🛠️ 系统工具模块</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">💻 硬件平台</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=hardware_platforms/nordic.html&from=/embedded_dev/hardware_platforms/nordic.html"><span class="label">Nordic nRF系列</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=hardware_platforms/esp32.html&from=/embedded_dev/hardware_platforms/esp32.html"><span class="label">ESP32系列</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=hardware_platforms/stm32.html&from=/embedded_dev/hardware_platforms/stm32.html"><span class="label">STM32系列</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">⚙️ 实时操作系统</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=rtos/zephyr.html&from=/embedded_dev/rtos/zephyr.html"><span class="label">Zephyr RTOS</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=rtos/freertos.html&from=/embedded_dev/rtos/freertos.html"><span class="label">FreeRTOS</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=rtos/rtthread.html&from=/embedded_dev/rtos/rtthread.html"><span class="label">RT-Thread</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">🔗 通信协议</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=protocols/bluetooth.html&from=/embedded_dev/protocols/bluetooth.html"><span class="label">蓝牙协议</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=protocols/wifi.html&from=/embedded_dev/protocols/wifi.html"><span class="label">WiFi协议</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=protocols/lora.html&from=/embedded_dev/protocols/lora.html"><span class="label">LoRa/LoRaWAN</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">🛠️ 开发工具</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=tools/ide.html&from=/embedded_dev/tools/ide.html"><span class="label">IDE环境</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=tools/debug.html&from=/embedded_dev/tools/debug.html"><span class="label">调试工具</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/lhfdoc.github.io/embedded_dev/no_translate.html?ref=tools/simulation.html&from=/embedded_dev/tools/simulation.html"><span class="label">仿真平台</span><span class=""></span></a></li>
</ul>
</li>
</ul>

            </div>
        </div>
        <div id="article">
            <div id="menu_wrapper">
                <div id="menu">
                </div>
            </div>
            <div id="content_wrapper">
                <div id="content_body">
                    <div id="article_head">
                        <div id="article_title">
                            
                            <h1>OpenEarable 2.0 源码架构分析</h1>
                            
                        </div>
                        <div id="article_tags">
                            <ul>
                            
                            </ul>
                        </div>
                        <div id="article_info">
                        <div id="article_info_left">
                            <span class="article_author">
                                
                            </span>
                            
                                <span class="article_date" title="最后修改日期： 2025-07-07">
                                    2025-07-07
                                </span>
                            
                        </div>
                        <div id="article_info_right">
                            
                        </div>
                        </div>
                    </div>
                    <div id="article_tools">
                        <span></span>
                        <span id="toc_btn"></span>
                    </div>
                    <div id="update_history">
                        
                    </div>
                    <div id="article_content">
                        
                            <h2 id="%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E6%A6%82%E8%A7%88">项目结构概览</h2>

<pre class="language-none"><code class="language-none">openearable-v2/
├── CMakeLists.txt              # 主构建配置文件
├── prj.conf                    # 项目配置文件
├── prj_release.conf           # 发布版本配置
├── prj_fota.conf              # FOTA版本配置
├── boards/                     # 板级支持包
│   └── teco/openearable_v2/   # OpenEarable v2硬件配置
├── src/                       # 源代码目录
│   ├── audio/                 # 音频处理模块
│   ├── Battery/               # 电源管理模块
│   ├── bluetooth/             # 蓝牙通信模块
│   ├── buttons/               # 按键处理模块
│   ├── drivers/               # 硬件驱动模块
│   ├── modules/               # 通用功能模块
│   ├── SensorManager/         # 传感器管理模块
│   ├── SD_Card/               # SD卡管理模块
│   ├── ParseInfo/             # 数据解析模块
│   ├── Wire/                  # I2C通信模块
│   └── utils/                 # 工具函数模块
├── unicast_server/            # 单播服务器应用
│   └── main.cpp               # 主入口文件
├── broadcast_sink/            # 广播接收器应用
├── include/                   # 公共头文件
└── tools/                     # 构建和烧录工具
</code></pre>
<h2 id="%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90">应用架构分析</h2>
<h3 id="%E4%B8%BB%E5%BA%94%E7%94%A8%E5%85%A5%E5%8F%A3-%28unicast_server/main.cpp%29">主应用入口 (unicast_server/main.cpp)</h3>
<p>项目主要以单播服务器模式运行，主要初始化流程：</p>
<ol>
<li><p><strong>系统初始化</strong></p>
<ul>
<li>电源管理器初始化</li>
<li>USB设备栈使能</li>
<li>音频流控制启动</li>
</ul>
</li>
<li><p><strong>状态管理</strong></p>
<ul>
<li>SIRK (Set Identity Resolving Key) 检查</li>
<li>配对状态设置</li>
<li>LED状态指示器初始化</li>
</ul>
</li>
<li><p><strong>服务初始化</strong></p>
<ul>
<li>传感器管理器初始化</li>
<li>蓝牙服务初始化（LED、电池、按键、传感器等）</li>
<li>数据解析服务初始化</li>
</ul>
</li>
</ol>
<h3 id="%E6%A0%B8%E5%BF%83%E6%A8%A1%E5%9D%97%E6%9E%B6%E6%9E%84">核心模块架构</h3>
<h4 id="1.-%E7%94%B5%E6%BA%90%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97-%28src/Battery/%29">1. 电源管理模块 (src/Battery/)</h4>
<ul>
<li><strong>PowerManager</strong>: 电源状态管理</li>
<li><strong>BQ27220</strong>: 电池监测芯片驱动</li>
<li><strong>BQ25120a</strong>: 电池充电管理芯片驱动</li>
<li><strong>BootState</strong>: 启动状态管理</li>
</ul>
<h4 id="2.-%E9%9F%B3%E9%A2%91%E5%A4%84%E7%90%86%E6%A8%A1%E5%9D%97-%28src/audio/%29">2. 音频处理模块 (src/audio/)</h4>
<ul>
<li><strong>audio_datapath</strong>: 音频数据路径处理</li>
<li><strong>audio_system</strong>: 音频子系统管理</li>
<li><strong>Equalizer</strong>: 音频均衡器</li>
<li><strong>streamctrl</strong>: 音频流控制</li>
<li><strong>pdm_mic</strong>: PDM麦克风驱动</li>
</ul>
<h4 id="3.-%E8%93%9D%E7%89%99%E9%80%9A%E4%BF%A1%E6%A8%A1%E5%9D%97-%28src/bluetooth/%29">3. 蓝牙通信模块 (src/bluetooth/)</h4>
<ul>
<li><strong>bt_management</strong>: 蓝牙连接管理</li>
<li><strong>bt_stream</strong>: 蓝牙音频流处理</li>
<li><strong>gatt_services</strong>: GATT服务实现<ul>
<li>device_info: 设备信息服务</li>
<li>battery_service: 电池服务</li>
<li>sensor_service: 传感器服务</li>
<li>led_service: LED控制服务</li>
<li>button_service: 按键服务</li>
</ul>
</li>
</ul>
<h4 id="4.-%E4%BC%A0%E6%84%9F%E5%99%A8%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97-%28src/SensorManager/%29">4. 传感器管理模块 (src/SensorManager/)</h4>
<ul>
<li><strong>SensorManager</strong>: 传感器统一管理接口</li>
<li><strong>DefaultSensors</strong>: 默认传感器配置</li>
<li><strong>SensorScheme</strong>: 传感器方案定义</li>
</ul>
<h4 id="5.-%E7%A1%AC%E4%BB%B6%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97-%28src/drivers/%29">5. 硬件驱动模块 (src/drivers/)</h4>
<ul>
<li><strong>ADAU1860</strong>: 音频编解码器驱动</li>
<li><strong>LED_Controller</strong>: LED控制驱动</li>
</ul>
<h4 id="6.-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%A8%A1%E5%9D%97-%28src/SD_Card/%29">6. 数据存储模块 (src/SD_Card/)</h4>
<ul>
<li><strong>SDLogger</strong>: SD卡数据记录</li>
<li><strong>SD_Card_Manager</strong>: SD卡管理</li>
<li><strong>Benchmark</strong>: 性能测试</li>
</ul>
<h4 id="7.-%E9%80%9A%E4%BF%A1%E6%A8%A1%E5%9D%97-%28src/Wire/%29">7. 通信模块 (src/Wire/)</h4>
<ul>
<li>I2C通信协议实现</li>
<li>传感器通信接口</li>
</ul>
<h4 id="8.-%E5%B7%A5%E5%85%B7%E6%A8%A1%E5%9D%97-%28src/utils/%29">8. 工具模块 (src/utils/)</h4>
<ul>
<li><strong>StateIndicator</strong>: 状态指示器</li>
<li><strong>macros</strong>: 通用宏定义</li>
<li><strong>fw_info</strong>: 固件信息管理</li>
</ul>
<h2 id="%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7">关键特性</h2>
<h3 id="%E5%A4%9A%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%84%E6%94%AF%E6%8C%81">多应用架构支持</h3>
<ul>
<li><strong>单播服务器</strong> (unicast_server): 主要应用模式，作为音频接收端</li>
<li><strong>广播接收器</strong> (broadcast_sink): 广播音频接收模式</li>
</ul>
<h3 id="%E6%A8%A1%E5%9D%97%E5%8C%96%E8%AE%BE%E8%AE%A1">模块化设计</h3>
<ul>
<li>每个功能模块都有独立的CMakeLists.txt</li>
<li>模块间通过定义良好的接口通信</li>
<li>支持模块的独立开发和测试</li>
</ul>
<h3 id="%E7%A1%AC%E4%BB%B6%E6%8A%BD%E8%B1%A1">硬件抽象</h3>
<ul>
<li>通过设备树(DTS)文件进行硬件配置</li>
<li>驱动层与应用层分离</li>
<li>支持多种硬件平台</li>
</ul>
<h3 id="%E7%94%B5%E6%BA%90%E7%AE%A1%E7%90%86">电源管理</h3>
<ul>
<li>完整的电池状态监控</li>
<li>充电状态管理</li>
<li>低功耗优化</li>
</ul>
<h3 id="%E4%BC%A0%E6%84%9F%E5%99%A8%E9%9B%86%E6%88%90">传感器集成</h3>
<ul>
<li>统一的传感器管理接口</li>
<li>支持多种传感器类型</li>
<li>可配置的采样率和数据格式</li>
</ul>
<h2 id="%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F">构建系统</h2>
<h3 id="CMake%E9%85%8D%E7%BD%AE">CMake配置</h3>
<ul>
<li>使用Zephyr RTOS构建系统</li>
<li>支持条件编译配置</li>
<li>模块化的子目录构建</li>
</ul>
<h3 id="%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">配置文件</h3>
<ul>
<li><strong>prj.conf</strong>: 基础配置</li>
<li><strong>prj_release.conf</strong>: 发布版本优化配置</li>
<li><strong>prj_fota.conf</strong>: 支持固件升级的配置</li>
</ul>
<h3 id="%E7%BC%96%E8%AF%91%E6%A0%87%E5%BF%97">编译标志</h3>
<ul>
<li><code>HEADSET=1</code>: 耳机模式</li>
<li><code>GATEWAY=2</code>: 网关模式</li>
<li>支持不同的音频配置和功能</li>
</ul>
<h2 id="%E6%A8%A1%E5%9D%97%E9%97%B4%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6">模块间通信机制</h2>
<h3 id="ZBus-%E6%B6%88%E6%81%AF%E6%80%BB%E7%BA%BF">ZBus 消息总线</h3>
<ul>
<li>基于Zephyr ZBus的发布-订阅模式</li>
<li>模块间解耦的异步通信</li>
<li>支持多订阅者的事件分发</li>
</ul>
<h3 id="%E5%85%B3%E9%94%AE%E6%B6%88%E6%81%AF%E7%B1%BB%E5%9E%8B">关键消息类型</h3>
<ul>
<li><strong>button_msg</strong>: 按键事件消息</li>
<li><strong>sensor_msg</strong>: 传感器数据消息</li>
<li><strong>battery_msg</strong>: 电池状态消息</li>
<li><strong>audio_msg</strong>: 音频状态消息</li>
</ul>
<h3 id="%E5%B7%A5%E4%BD%9C%E9%98%9F%E5%88%97%E5%92%8C%E7%BA%BF%E7%A8%8B">工作队列和线程</h3>
<ul>
<li>各模块使用独立的工作队列</li>
<li>优先级配置的多线程架构</li>
<li>中断安全的消息传递</li>
</ul>
<h2 id="%E6%95%B0%E6%8D%AE%E6%B5%81%E5%88%86%E6%9E%90">数据流分析</h2>
<h3 id="%E9%9F%B3%E9%A2%91%E6%95%B0%E6%8D%AE%E6%B5%81">音频数据流</h3>

<pre class="language-none"><code class="language-none">PDM麦克风 → 音频数据路径 → 均衡器处理 → 蓝牙LE Audio → 远程设备
</code></pre>
<h3 id="%E4%BC%A0%E6%84%9F%E5%99%A8%E6%95%B0%E6%8D%AE%E6%B5%81">传感器数据流</h3>

<pre class="language-none"><code class="language-none">物理传感器 → 传感器管理器 → 数据融合 → 蓝牙GATT → 客户端应用
                                    ↓
                                SD卡存储
</code></pre>
<h3 id="%E6%8E%A7%E5%88%B6%E6%B5%81">控制流</h3>

<pre class="language-none"><code class="language-none">物理按键 → 按键管理器 → ZBus消息 → 各功能模块 → 状态更新 → LED指示
</code></pre>
<h2 id="%E5%8A%9F%E8%80%97%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5">功耗优化策略</h2>
<h3 id="%E5%8A%A8%E6%80%81%E9%A2%91%E7%8E%87%E8%B0%83%E8%8A%82">动态频率调节</h3>
<ul>
<li>根据工作负载调整CPU频率</li>
<li>传感器按需采样</li>
<li>音频流自适应比特率</li>
</ul>
<h3 id="%E5%A4%96%E8%AE%BE%E7%AE%A1%E7%90%86">外设管理</h3>
<ul>
<li>未使用外设的自动关闭</li>
<li>I2C/SPI接口的低功耗模式</li>
<li>GPIO引脚的合理配置</li>
</ul>
<h3 id="%E7%9D%A1%E7%9C%A0%E6%9C%BA%E5%88%B6">睡眠机制</h3>
<ul>
<li>系统空闲时进入低功耗模式</li>
<li>中断唤醒机制</li>
<li>电池电量监控和保护</li>
</ul>
<h2 id="%E5%AE%8C%E6%95%B4%E6%A8%A1%E5%9D%97%E6%96%87%E6%A1%A3">完整模块文档</h2>
<p>以下是各核心模块的详细分析文档：</p>
<h3 id="%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97">核心功能模块</h3>
<ol>
<li><strong><a href="../modules/battery-module.html"  >电源管理模块</a></strong> - 电池监控、充电管理、功耗优化</li>
<li><strong><a href="../modules/audio-module.html"  >音频处理模块</a></strong> - 音频采集、处理、流控制</li>
<li><strong><a href="../modules/sensor-module.html"  >传感器管理模块</a></strong> - 多传感器融合、数据处理</li>
<li><strong><a href="../modules/bluetooth-module.html"  >蓝牙通信模块</a></strong> - LE Audio、GATT服务、连接管理</li>
<li><strong><a href="../modules/storage-module.html"  >数据存储模块</a></strong> - SD卡管理、数据记录</li>
<li><strong><a href="../modules/drivers-module.html"  >硬件驱动模块</a></strong> - 音频编解码器、LED控制器</li>
</ol>
<h3 id="%E8%BE%85%E5%8A%A9%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97">辅助功能模块</h3>
<ol start="7">
<li><strong><a href="../modules/buttons-module.html"  >按键处理模块</a></strong> - 物理按键、防抖处理、事件分发</li>
<li><strong><a href="../modules/parseinfo-module.html"  >数据解析模块</a></strong> - 传感器数据格式、蓝牙配置信息</li>
<li><strong><a href="../modules/wire-module.html"  >I2C通信模块</a></strong> - Arduino兼容I2C接口、设备通信</li>
<li><strong><a href="../modules/utils-module.html"  >系统工具模块</a></strong> - 状态指示、版本管理、错误处理</li>
</ol>
<h2 id="%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97">开发指南</h2>
<h3 id="%E6%B7%BB%E5%8A%A0%E6%96%B0%E4%BC%A0%E6%84%9F%E5%99%A8">添加新传感器</h3>
<ol>
<li>在 <code>src/drivers/</code> 下创建驱动文件</li>
<li>在 <code>src/SensorManager/</code> 中注册传感器</li>
<li>在 <code>src/ParseInfo/</code> 中定义数据格式</li>
<li>在 <code>src/bluetooth/gatt_services/</code> 中添加GATT特性</li>
</ol>
<h3 id="%E6%B7%BB%E5%8A%A0%E6%96%B0%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97">添加新功能模块</h3>
<ol>
<li>创建模块目录和CMakeLists.txt</li>
<li>定义模块接口和数据结构</li>
<li>实现ZBus消息处理</li>
<li>在主应用中集成模块</li>
</ol>
<h3 id="%E8%B0%83%E8%AF%95%E5%92%8C%E6%B5%8B%E8%AF%95">调试和测试</h3>
<ul>
<li>使用Zephyr日志系统</li>
<li>通过UART或RTT输出调试信息</li>
<li>单元测试和集成测试框架</li>
</ul>
<h2 id="%E6%80%BB%E7%BB%93">总结</h2>
<p>OpenEarable 2.0采用了现代化的嵌入式系统架构设计，具有以下特点：</p>
<ol>
<li><strong>模块化设计</strong>: 功能模块高度解耦，便于开发和维护</li>
<li><strong>消息驱动</strong>: 基于ZBus的异步消息通信机制</li>
<li><strong>多应用支持</strong>: 支持不同的应用场景和配置</li>
<li><strong>硬件抽象</strong>: 良好的硬件抽象层，支持多平台移植</li>
<li><strong>功耗优化</strong>: 全面的功耗管理和优化策略</li>
<li><strong>可扩展性</strong>: 易于添加新功能和传感器</li>
<li><strong>可调试性</strong>: 完善的日志和调试机制</li>
</ol>
<p>该架构为智能可穿戴设备的开发提供了完整的解决方案，是一个值得学习和借鉴的优秀开源项目。</p>
<hr />
<p><em>本文档基于OpenEarable 2.0源码深度分析生成，各模块的详细技术文档请参考相关链接。</em></p>

                        
                    </div>
                </div>
                <div id="previous_next">
                    <div id="previous">
                        
                        <a href="/lhfdoc.github.io/embedded_dev/openearable/project-overview.html">
                            <span class="icon"></span>
                            <span class="label">📋 项目概述</span>
                        </a>
                        
                    </div>
                    <div id="next">
                        
                        <a href="/lhfdoc.github.io/embedded_dev/openearable/deployment.html">
                            <span class="label">🚀 部署指南</span>
                            <span class="icon"></span>
                        </a>
                        
                    </div>
                </div>
                <div id="comments-container"></div>
            </div>
            <div id="toc_wrapper">
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a id="to_top" href="#"></a>
    <div id="doc_footer">
        <div id="footer">
            <div id="footer_top">
                <ul>
<li><a>相关资源</a><ul><li><a target="_blank" href="https://www.nordicsemi.com/">Nordic官网</a></li>
<li><a target="_blank" href="https://zephyrproject.org/">Zephyr项目</a></li>
</ul>
</li>
</ul>

            </div>
            <div id="footer_bottom">
                <ul>
</ul>

            </div>
        </div>
    </div>
    
        <script src="/lhfdoc.github.io/teedoc-plugin-markdown-parser/mermaid.min.js"></script>
    
        <script>mermaid.initialize({startOnLoad:true});</script>
    
        <script src="/lhfdoc.github.io/static/js/theme_default/tocbot.min.js"></script>
    
        <script src="/lhfdoc.github.io/static/js/theme_default/main.js"></script>
    
        <script src="/lhfdoc.github.io/static/js/theme_default/viewer.min.js"></script>
    
        <script src="/lhfdoc.github.io/static/css/theme_default/prism.min.js"></script>
    
        <script src="/lhfdoc.github.io/static/js/search/search_main.js"></script>
    
        <script src="/lhfdoc.github.io/static/js/custom.js"></script>
    
</body>

</html>